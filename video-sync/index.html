<body>
  <video id="video" preload muted src="/boot/screenplay.mp4"
    style="width: 100%; height: 100%; object-fit: fill;"></video>
  <script>
    const video = document.getElementById('video');

    // Add an event listener for the 'loadedmetadata' event
    video.addEventListener('loadedmetadata', () => {
      // Parse the URL to get query parameters
      const urlParams = new URLSearchParams(window.location.search);
      // Check if the "ip" query parameter is present
      const ip = urlParams.get('ip');
      // Set the WebSocket URL based on the presence of the "ip" parameter
      const wsUrl = ip ? `ws://${ip}:8080` : 'ws://localhost:8080';

      const ws = new WebSocket(wsUrl);

      ws.onmessage = (event) => {
        if (event.data === 'play') {
          video.play();
        } else if (event.data === 'restart') {
          video.currentTime = 0;
          video.play();
        }
      };

      ws.onopen = () => { ws.send('start'); };

      video.addEventListener('ended', () => {
        ws.send('restart');
      });
    });
  </script>
</body>

</html>